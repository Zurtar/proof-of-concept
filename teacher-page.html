<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="css/globals.css"/>
    <link rel="stylesheet" href="css/styleguide.css"/>
    <link rel="stylesheet" href="css/style.css"/>
    <link href='https://fonts.googleapis.com/css?family=Comfortaa' rel='stylesheet'>
</head>
<body>
<div class="WF-utility-app-wrapper">
    <header>
        <div class="WF-title-bar">
            <div class="scheduling-input">myScheduling</div>
            <img class="logo" src="img/QuickLULogo.png"/>
        </div>
    </header>

    <table class="input-table">
        <tr>
            <td>
                <div class="spacer-wrap">
                    <table>
                        <tbody>
                        <tr>
                            <td style="border: 1px solid black;">
                                <div>
                                    <table class="ludTableGrid ludTableGridLight XWBP-Table">
                                        <thead>
                                        <tr>
                                            <th class="ludLabel" colspan="2" rowspan="1" align="center"
                                                style="width: min-content; padding-right: 10px;">Fall
                                            </th>
                                            <th class="ludLabel" colspan="2" rowspan="1" align="center" style="">
                                                Monday
                                            </th>
                                            <th class="ludLabel" colspan="2" rowspan="1" align="center" style="">
                                                Tuesday
                                            </th>
                                            <th class="ludLabel" colspan="2" rowspan="1" align="center" style="">
                                                Wednesday
                                            </th>
                                            <th class="ludLabel" colspan="2" rowspan="1" align="center" style="">
                                                Thursday
                                            </th>
                                            <th class="ludLabel" colspan="2" rowspan="1" align="center" style="">
                                                Friday
                                            </th>
                                        </tr>
                                        </thead>
                                    </table>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <div class="schedule-wrapper">
                                    <table class="ludTableGrid ludTableGridLight XWBP-Table">
                                        <tbody>
                                        <tr>
                                            <td class="ludLabel" rowspan="1" align="center" style="width:10px;">
                                                07:30 AM
                                            </td>
                                            <td><br></td>
                                            <td><br></td>
                                            <td><br></td>
                                            <td><br></td>
                                            <td><br></td>
                                        </tr>
                                        <tr>
                                            <td class="ludLabel" rowspan="1" align="center" style="width:10px;">
                                                08:00 AM
                                            </td>
                                            <td><br></td>
                                            <td><br></td>
                                            <td><br></td>
                                            <td><br></td>
                                            <td><br></td>
                                        </tr>
                                        <tr>
                                            <td class="ludLabel" rowspan="1" align="center" style="width:10px;">
                                                08:30 AM
                                            </td>
                                            <td><br></td>
                                            <td><br></td>
                                            <td><br></td>
                                            <td><br></td>
                                            <td><br></td>
                                        </tr>
                                        <tr>
                                            <td class="ludLabel" rowspan="1" align="center" style="width:10px;">
                                                09:00 AM
                                            </td>
                                            <td><br></td>
                                            <td><br></td>
                                            <td><br></td>
                                            <td><br></td>
                                            <td><br></td>
                                        </tr>
                                        <tr>
                                            <td class="ludLabel" rowspan="1" align="center" style="width:10px;">
                                                09:30 AM
                                            </td>
                                            <td><br></td>
                                            <td><br></td>
                                            <td><br></td>
                                            <td><br></td>
                                            <td><br></td>
                                        </tr>
                                        <tr>
                                            <td class="ludLabel" rowspan="1" align="center" style="width:10px;">
                                                10:00 AM
                                            </td>
                                            <td rowspan="3" class="ludHLNormal" style="border:1px solid black;">
                                                Math-3332-FA<br>RB-3026<br>Dr.
                                                L. Santiago Moreno
                                            </td>
                                            <td><br></td>
                                            <td rowspan="3" class="ludHLNormal" style="border:1px solid black;">
                                                Math-3332-FA<br>RB-3026<br>Dr.
                                                L. Santiago Moreno
                                            </td>
                                            <td><br></td>
                                            <td><br></td>
                                        </tr>
                                        <tr>
                                            <td class="ludLabel" rowspan="1" align="center" style="width:10px;">
                                                10:30 AM
                                            </td>
                                            <td rowspan="2" class="ludHLNormal" style="border:1px solid black;">
                                                Math-3332L-F1<br>LAB<br>RB-1022<br>Dr.
                                                L. Santiago Moreno
                                            </td>
                                            <td><br></td>
                                            <td><br></td>
                                        </tr>
                                        <tr>
                                            <td class="ludLabel" rowspan="1" align="center" style="width:10px;">
                                                11:00 AM
                                            </td>
                                            <td><br></td>
                                            <td><br></td>
                                        </tr>
                                        <tr>
                                            <td class="ludLabel" rowspan="1" align="center" style="width:10px;">
                                                11:30 AM
                                            </td>
                                            <td><br></td>
                                            <td><br></td>
                                            <td><br></td>
                                            <td><br></td>
                                            <td><br></td>
                                        </tr>
                                        <tr>
                                            <td class="ludLabel" rowspan="1" align="center" style="width:10px;">
                                                12:00 PM
                                            </td>
                                            <td><br></td>
                                            <td><br></td>
                                            <td><br></td>
                                            <td><br></td>
                                            <td><br></td>
                                        </tr>
                                        <tr>
                                            <td class="ludLabel" rowspan="1" align="center" style="width:10px;">
                                                12:30 PM
                                            </td>
                                            <td><br></td>
                                            <td><br></td>
                                            <td><br></td>
                                            <td><br></td>
                                            <td><br></td>
                                        </tr>
                                        <tr>
                                            <td class="ludLabel" rowspan="1" align="center" style="width:10px;">
                                                01:00 PM
                                            </td>
                                            <td><br></td>
                                            <td><br></td>
                                            <td><br></td>
                                            <td><br></td>
                                            <td><br></td>
                                        </tr>
                                        <tr>
                                            <td class="ludLabel" rowspan="1" align="center" style="width:10px;">
                                                01:30 PM
                                            </td>
                                            <td><br></td>
                                            <td rowspan="2" class="ludHLNormal" style="border:1px solid black;">
                                                Comp-1411L-F1<br>LAB<br>AT-4019<br>Dr.
                                                A. Nazari Shirehjini
                                            </td>
                                            <td><br></td>
                                            <td><br></td>
                                            <td><br></td>
                                        </tr>
                                        <tr>
                                            <td class="ludLabel" rowspan="1" align="center" style="width:10px;">
                                                02:00 PM
                                            </td>
                                            <td><br></td>
                                            <td><br></td>
                                            <td><br></td>
                                            <td><br></td>
                                        </tr>
                                        <tr>
                                            <td class="ludLabel" rowspan="1" align="center" style="width:10px;">
                                                02:30 PM
                                            </td>
                                            <td rowspan="3" class="ludHLNormal" style="border:1px solid black;">
                                                Comp-1411L-FA<br><br><br>Dr.
                                                A. Nazari Shirehjini
                                            </td>
                                            <td rowspan="2" class="ludHLNormal" style="border:1px solid black;">
                                                Comp-3413L-F1<br>LAB<br>AT-3002<br>Mr.
                                                M. Moniruzzaman
                                            </td>
                                            <td rowspan="3" class="ludHLNormal" style="border:1px solid black;">
                                                Comp-1411-FA<br><br><br>Dr.
                                                A. Nazari Shirehjini
                                            </td>
                                            <td><br></td>
                                            <td rowspan="6" class="ludHLNormal" style="border:1px solid black;">
                                                Comp-4478-FA<br>RB-1022<br>Dr.
                                                S. Mohammed
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="ludLabel" rowspan="1" align="center" style="width:10px;">
                                                03:00 PM
                                            </td>
                                            <td><br></td>
                                        </tr>
                                        <tr>
                                            <td class="ludLabel" rowspan="1" align="center" style="width:10px;">
                                                03:30 PM
                                            </td>
                                            <td><br></td>
                                            <td><br></td>
                                        </tr>
                                        <tr>
                                            <td class="ludLabel" rowspan="1" align="center" style="width:10px;">
                                                04:00 PM
                                            </td>
                                            <td rowspan="3" class="ludHLNormal" style="border:1px solid black;">
                                                Comp-2453-FA<br>AT-1007<br>Dr.
                                                A. Safaei
                                            </td>
                                            <td><br></td>
                                            <td rowspan="3" class="ludHLNormal" style="border:1px solid black;">
                                                Comp-2453-FA<br>AT-1007<br>Dr.
                                                A. Safaei
                                            </td>
                                            <td><br></td>
                                        </tr>
                                        <tr>
                                            <td class="ludLabel" rowspan="1" align="center" style="width:10px;">
                                                04:30 PM
                                            </td>
                                            <td><br></td>
                                            <td><br></td>
                                        </tr>
                                        <tr>
                                            <td class="ludLabel" rowspan="1" align="center" style="width:10px;">
                                                05:00 PM
                                            </td>
                                            <td><br></td>
                                            <td><br></td>
                                        </tr>
                                        <tr>
                                            <td class="ludLabel" rowspan="1" align="center" style="width:10px;">
                                                05:30 PM
                                            </td>
                                            <td><br></td>
                                            <td><br></td>
                                            <td><br></td>
                                            <td><br></td>
                                            <td rowspan="6" class="ludHLNormal" style="border:1px solid black;">
                                                Comp-3413-FA<br>RC-1002<br>Mr.
                                                M. Moniruzzaman
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="ludLabel" rowspan="1" align="center" style="width:10px;">
                                                06:00 PM
                                            </td>
                                            <td><br></td>
                                            <td><br></td>
                                            <td><br></td>
                                            <td><br></td>
                                        </tr>
                                        <tr>
                                            <td class="ludLabel" rowspan="1" align="center" style="width:10px;">
                                                06:30 PM
                                            </td>
                                            <td><br></td>
                                            <td><br></td>
                                            <td><br></td>
                                            <td><br></td>
                                        </tr>
                                        <tr>
                                            <td class="ludLabel" rowspan="1" align="center" style="width:10px;">
                                                07:00 PM
                                            </td>
                                            <td><br></td>
                                            <td><br></td>
                                            <td><br></td>
                                            <td><br></td>
                                        </tr>
                                        <tr>
                                            <td class="ludLabel" rowspan="1" align="center" style="width:10px;">
                                                07:30 PM
                                            </td>
                                            <td><br></td>
                                            <td><br></td>
                                            <td><br></td>
                                            <td><br></td>
                                        </tr>
                                        <tr>
                                            <td class="ludLabel" rowspan="1" align="center" style="width:10px;">
                                                08:00 PM
                                            </td>
                                            <td><br></td>
                                            <td><br></td>
                                            <td><br></td>
                                            <td><br></td>
                                        </tr>
                                        <tr>
                                            <td class="ludLabel" rowspan="1" align="center" style="width:10px;">
                                                08:30 PM
                                            </td>
                                            <td><br></td>
                                            <td><br></td>
                                            <td><br></td>
                                            <td><br></td>
                                            <td><br></td>
                                        </tr>
                                        <tr>
                                            <td class="ludLabel" rowspan="1" align="center" style="width:10px;">
                                                09:00 PM
                                            </td>
                                            <td><br></td>
                                            <td><br></td>
                                            <td><br></td>
                                            <td><br></td>
                                            <td><br></td>
                                        </tr>
                                        <tr>
                                            <td class="ludLabel" rowspan="1" align="center" style="width:10px;">
                                                09:30 PM
                                            </td>
                                            <td><br></td>
                                            <td><br></td>
                                            <td><br></td>
                                            <td><br></td>
                                            <td><br></td>
                                        </tr>
                                        <tr>
                                            <td class="ludLabel" rowspan="1" align="center" style="width:10px;">
                                                10:00 PM
                                            </td>
                                            <td><br></td>
                                            <td><br></td>
                                            <td><br></td>
                                            <td><br></td>
                                            <td><br></td>
                                        </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>

            </td>
            <td class="spacing-td"></td>
            <td>
                <!--                <div style="max-height: 70vh; overflow: scroll">-->
                <table class="input-table-2">
                    <tbody style="vertical-align: baseline; max-height: 70vh; overflow: scroll;">
                    <tr style="height: 0px">
                        <th>
                            <div class="course-search-input" style="margin-bottom: 0px">
                                <div class="label">Input Course Change:</div>
                                <select id="classList" name="classList" class="text-input"
                                        onchange="populateTimeSlots()"></select>
                            </div>
                        </th>
                    </tr>
                    <tr style="height: 0px">
                        <td>
                            <div style=" max-height: 35vh;overflow: scroll;">
                                <table id="timeslot-list">
                                </table>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td style="vertical-align: bottom;">
                            <button class="next-btn" type="button"
                                    onclick="alert('Students, Notified! Thank you.')">Submit
                            </button>
                        </td>
                    </tr>
                    </tbody>
                </table>
                <!--                </div>-->
            </td>

        </tr>
    </table>
</div>

</body>

<script>

    let teachersCourses = [];
    init();

    function init() {
        loadJSON(function (response) {
            // Parse JSON string into object
            teachersCourses = JSON.parse(response).Courses;

            console.log(teachersCourses);

            courseSearchList();
        });
    }

    function loadJSON(callback) {
        var xobj = new XMLHttpRequest();
        xobj.overrideMimeType("application/json");
        xobj.open('GET', 'teachersClasses.json', true);
        xobj.onreadystatechange = function () {
            if (xobj.readyState == 4 && xobj.status == "200") {
                callback(xobj.responseText);
            }
        };
        xobj.send(null);
    }

    function courseSearchList() {
        var list = document.getElementById("classList");
        for (course of teachersCourses) {
            list.innerHTML += '<option value="' + course.Id + '">' + course.CourseCode + '</option>';
        }
    }

    function populateTimeSlots() {
        let timeSlotList = document.getElementById("timeslot-list");
        let courseID = document.getElementById("classList").value;

        // I missed this
        let course = teachersCourses.find(course => course.Id == courseID);
        let timeSlots = [];

        timeSlots = course.PossibleTimeSlots;

        timeSlotList.innerHTML = '';
        //
        // timeSlotList.innerHTML = `                    <table class="input-table-2" id="timeslot-list">
        //                 <tbody style="vertical-align: baseline">
        //                 <tr>
        //                     <td>
        //                         <div class="course-search-input">
        //                             <div class="label">Input Course Change:</div>
        //                            ` +
        //     document.getElementById("classList").outerHTML
        //     + `
        //                         </div>
        //                     </td>
        //                 </tr>`;

        for (timeSlot of timeSlots) {
            let timeSlotElement = timeSlotList.insertRow();

            timeSlotElement.timeSlotID = timeSlot.TimeSlotID;

            timeSlotElement.classList.add("WF-option");
            timeSlotElement.id = timeSlotElement.timeSlotID;


            let timeSlotHTMLString = `<td><div class="expanded-class-version">
                    <div class="text-wrapper-3">
                    <input type="checkbox" id="course_select_` + timeSlot.TimeSlotID + `" hidden="hidden">
                        <table class="timeslot-table">
                            <tbody>
                            <tr>
                                <td><span>` + course.Title + ": " + timeSlot.TimeSlotString + `&nbsp;&nbsp;&nbsp;&nbsp;</span></td>
                                <td><span style="color: darkgreen">` + (100 - Math.floor(parseInt(timeSlot.StudentsWithoutConflict) / parseInt(timeSlot.StudentCount) * 100)) + `%</span></td>
                            </tr>
                            <tr class="` + timeSlot.TimeSlotID + `" hidden="hidden">
                                <td><span>Students Unaffected:</span></td>
                                <td><span>` + timeSlot.StudentsWithoutConflict + "/" + timeSlot.StudentCount + `</span></td>
                            </tr>
                           <tr class="` + timeSlot.TimeSlotID + `"  hidden="hidden">
                                <td><span>Student Conflicts:</span></td>
                                <td><span>` + timeSlot.StudentsWithConflict + "/" + timeSlot.StudentCount + `</span></td>
                            </tr>
                               <tr class="` + timeSlot.TimeSlotID + `"  hidden="hidden">
                                <td><span>Required Conflicts:</span></td>
                                <td><span>` + timeSlot.RequiredCourseStudents + "/" + timeSlot.StudentCount + `</span></td>
                            </tr>
                             <tr class="` + timeSlot.TimeSlotID + `"  hidden="hidden">
                                <td><span>Elective Conflicts:</span></td>
                                <td><span>` + timeSlot.ElectiveCourseStudents + "/" + timeSlot.StudentCount + `</span></td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div></td>`;

            timeSlotElement.innerHTML = timeSlotHTMLString;
            // timeSlotList.innerHTML += timeSlotElement.toString();
            // timeSlotList.appendChild(timeSlotElement);

            timeSlotElement.onclick = function () {
                selectCourse(this.timeSlotID)
            };
        }

        // timeSlotList.innerHTML += `                        <tr>
        //                     <td style="vertical-align: bottom;">
        //                         <button class="next-btn" type="button" onclick="alert('Students, Notified! Thank you.')">Submit
        //                         </button>
        //                     </td>
        //                 </tr>
        //                 </tbody>
        //             </table>`;

        document.getElementById("classList").value = courseID;
    }

    function selectCourse(course) {
        let elements = [];

        elements = document.getElementsByClassName(course);
        for (element of elements)
            element.hidden = !element.hidden;
    }


</script>

</html>
